"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[394],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>h});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),p=c(a),u=i,h=p["".concat(s,".").concat(u)]||p[u]||d[u]||r;return a?n.createElement(h,o(o({ref:t},m),{},{components:a})):n.createElement(h,o({ref:t},m))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:i,o[1]=l;for(var c=2;c<r;c++)o[c]=a[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},7170:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var n=a(7462),i=(a(7294),a(3905));const r={slug:"/"},o="Introduction",l={unversionedId:"Introduction",id:"Introduction",title:"Introduction",description:"FMMAX: Fourier Modal Method with Jax",source:"@site/docs/Introduction.md",sourceDirName:".",slug:"/",permalink:"/fmmax/",draft:!1,editUrl:"https://github.com/facebookresearch/fmmax/docs/Introduction.md",tags:[],version:"current",frontMatter:{slug:"/"},sidebar:"docsSidebar",next:{title:"Metal Grating",permalink:"/fmmax/Tutorials/metal_grating"}},s={},c=[{value:"FMMAX: Fourier Modal Method with Jax",id:"fmmax-fourier-modal-method-with-jax",level:2},{value:"Brillouin zone integration",id:"brillouin-zone-integration",level:2},{value:"Vector FMM formulations",id:"vector-fmm-formulations",level:2},{value:"Anisotropic, magnetic materials",id:"anisotropic-magnetic-materials",level:2},{value:"FMM Conventions",id:"fmm-conventions",level:2},{value:"Batching",id:"batching",level:2},{value:"Installation",id:"installation",level:2},{value:"Citing FMMAX",id:"citing-fmmax",level:2},{value:"License",id:"license",level:2},{value:"References",id:"references",level:2}],m={toc:c},p="wrapper";function d(e){let{components:t,...r}=e;return(0,i.kt)(p,(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"introduction"},"Introduction"),(0,i.kt)("h2",{id:"fmmax-fourier-modal-method-with-jax"},"FMMAX: Fourier Modal Method with Jax"),(0,i.kt)("p",null,"FMMAX is a an implementation of the Fourier modal method (FMM) in ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/google/jax"},"JAX"),". "),(0,i.kt)("p",null,"The FMM -- also known as rigorous coupled wave analysis (RCWA) -- is a semianalytical method that solves Maxwell's equations in periodic stratified media, where in-plane directions are treated with a truncated Fourier basis and the normal direction is handled by a scattering matrix approach ","[1999 Whittaker, 2012 Liu, 2020 Jin]",". This allows certain classes of structures to be modeled with relatively low computational cost."),(0,i.kt)("p",null,"Our use of JAX enables GPU acceleration and automatic differentiation of FMM simulations. Besides these features, FMMAX is differentiated from other codes by its support for Brillouin zone integration, advanced vector FMM formulations which improve convergence, and anisotropic and magnetic materials."),(0,i.kt)("h2",{id:"brillouin-zone-integration"},"Brillouin zone integration"),(0,i.kt)("p",null,"Brillouin zone integration ","[2022 Lopez-Fraguas]"," allows modeling of localized sources in periodic structures. Check out the ",(0,i.kt)("inlineCode",{parentName:"p"},"crystal")," example to see how we model a Gaussian beam incident upon a photonic crystal slab, or an isolated dipole embedded within the slab. The Gaussian beam fields are shown below."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Gaussian beam incident on photonic crystal",src:a(7188).Z,width:"719",height:"384"})),(0,i.kt)("h2",{id:"vector-fmm-formulations"},"Vector FMM formulations"),(0,i.kt)("p",null,"Vector FMM formulations introduce local coordinate systems at each point in the unit cell, which are normal and tangent to all interfaces. This allows normal and tangent field components to be treated differently and improves convergence. FMMAX implements several vector formulations of the FMM, with automatic vector field generation based on functional minimization similar to ","[2012 Liu]",". We implement the ",(0,i.kt)("em",{parentName:"p"},"Pol"),", ",(0,i.kt)("em",{parentName:"p"},"Normal"),", and ",(0,i.kt)("em",{parentName:"p"},"Jones")," methods of that reference, and introduce a new ",(0,i.kt)("em",{parentName:"p"},"Jones direct")," method which we have found to have superior convergence. These are supported also with anisotropic and magnetic materials. The ",(0,i.kt)("inlineCode",{parentName:"p"},"vector_fields")," example computes vector fields by these methods for an example structure."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Comparison of automatically-generated vector fields",src:a(4680).Z,width:"719",height:"209"})),(0,i.kt)("h2",{id:"anisotropic-magnetic-materials"},"Anisotropic, magnetic materials"),(0,i.kt)("p",null,"Our support of anisotropic, magnetic materials allows modeling of uniaxial perfectly matched layers. This is demonstrated in the ",(0,i.kt)("inlineCode",{parentName:"p"},"metal_dipole")," example, which simulates in vaccuum located above a metal substrate. The resulting electric fields are whown below."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Dipole suspended above metal substrate with PML",src:a(2220).Z,width:"400",height:"247"})),(0,i.kt)("h2",{id:"fmm-conventions"},"FMM Conventions"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The speed of light, vacuum permittivity, and vacuum permeability are all 1."),(0,i.kt)("li",{parentName:"ul"},"Fields evolve in time as $\\exp(-i \\omega t)$."),(0,i.kt)("li",{parentName:"ul"},"If $\\mathbf{u}$ and $\\mathbf{v}$ are the primitive lattice vectors, the unit cell is defined by the parallelogram with vertices at $\\mathbf{0}$, $\\mathbf{u}$, $\\mathbf{u} + \\mathbf{v}$, and $\\mathbf{v}$."),(0,i.kt)("li",{parentName:"ul"},"For quantities defined on a grid (such as the permittivity distribution of a patterned layer) the value at grid index (0, 0) corresponds to the value at physical location $\\mathbf{0}$."),(0,i.kt)("li",{parentName:"ul"},"The scattering matrix block $\\mathbf{S}_{11}$ relates incident and transmitted forward-going fields, and other blocks have corresponding definitions. This differs from the convention e.g. in photonic integrated circuits.")),(0,i.kt)("h2",{id:"batching"},"Batching"),(0,i.kt)("p",null,"Batched calculations are supported, and should be used where possible to avoid looping. The batch axes are the leading axes, except for the wave amplitudes and electromagnetic fields, where a trailing batch axis is assumed. This allows e.g. computing the transmission through a structure for multiple polarizations via a matrix-matrix operation (",(0,i.kt)("inlineCode",{parentName:"p"},"transmitted_amplitudes = S11 @ incident_amplitudes"),"), rather than a batched matrix-vector operation."),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("p",null,"FMMAX can be installed via pip:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"pip install fmmax\n")),(0,i.kt)("h2",{id:"citing-fmmax"},"Citing FMMAX"),(0,i.kt)("p",null,"If you use FMMAX, please consider citing ",(0,i.kt)("a",{parentName:"p",href:"https://arxiv.org/abs/2308.08573"},"our paper"),","),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"@misc{schubert2023fourier,\n      title={Fourier modal method for inverse design of metasurface-enhanced micro-LEDs}, \n      author={Martin F. Schubert and Alec M. Hammond},\n      year={2023},\n      eprint={2308.08573},\n      archivePrefix={arXiv},\n      primaryClass={physics.comp-ph}\n}\n")),(0,i.kt)("h2",{id:"license"},"License"),(0,i.kt)("p",null,"FMMAX is licensed under the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/facebookresearch/fmmax/blob/main/LICENSE"},"MIT license"),"."),(0,i.kt)("h2",{id:"references"},"References"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"[2012 Liu]"," V. Liu and S. Fan, ",(0,i.kt)("a",{parentName:"p",href:"https://www.sciencedirect.com/science/article/pii/S0010465512001658"},"S4: A free electromagnetic solver for layered structures structures"),", ",(0,i.kt)("em",{parentName:"p"},"Comput. Phys. Commun.")," ",(0,i.kt)("strong",{parentName:"p"},"183"),", 2233-2244 (2012).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"[1999 Whittaker]"," D. M. Whittaker and I. S. Culshaw, ",(0,i.kt)("a",{parentName:"p",href:"https://journals.aps.org/prb/abstract/10.1103/PhysRevB.60.2610"},"Scattering-matrix treatment of patterned multilayer photonic structures"),", ",(0,i.kt)("em",{parentName:"p"},"Phys. Rev. B")," ",(0,i.kt)("strong",{parentName:"p"},"60"),", 2610 (1999).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"[2020 Jin]"," W. Jin, W. Li, M. Orenstein, and S. Fan ",(0,i.kt)("a",{parentName:"p",href:"https://pubs.acs.org/doi/10.1021/acsphotonics.0c00768"},"Inverse design of lightweight broadband reflector for relativistic lightsail propulsion"),", ",(0,i.kt)("em",{parentName:"p"},"ACS Photonics")," ",(0,i.kt)("strong",{parentName:"p"},"7"),", 9, 2350-2355 (2020).")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"[2022 Lopez-Fraguas]"," E. Lopez-Fraguas, F. Binkowski, S. Burger, B. Garcia-Camara, R. Vergaz, C. Becker and P. Manley ",(0,i.kt)("a",{parentName:"p",href:"https://www.nature.com/articles/s41598-022-15499-7"},"Tripling the light extraction efficiency of a deep ultraviolet LED using a nanostructured p-contact"),", ",(0,i.kt)("em",{parentName:"p"},"Scientific Reports")," ",(0,i.kt)("strong",{parentName:"p"},"12"),", 11480 (2022)."))))}d.isMDXComponent=!0},7188:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/crystal_beam-789f8e02a65d2ba3d111bd2d72ed4e79.gif"},2220:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/metal_dipole-e096841a357eb58f9efe29310d3ae17c.png"},4680:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/vector_fields-c1fd284c5b7f5ec48e5e7380b550bd80.png"}}]);